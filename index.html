<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulaire RSVP - Air Arlette</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #f7f9fc;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .form-container {
      display: flex;
      gap: 32px;
      background: #fff;
      padding: 24px;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      max-width: 900px;
      width: 100%;
    }

    .form-columns {
      display: flex;
      flex: 1;
      gap: 32px;
    }

    .form-left, .form-right {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .form-left {
      padding-right: 32px;
      position: relative;
    }

    .form-left::after {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 2px;
      height: 100%;
      background: #e0e0e0;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      font-size: 14px;
      color: #333;
    }

    input, select, button {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }

    button {
      background: #007BFF;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: background 0.3s;
    }

    button:hover {
      background: #0056b3;
    }

    /* Zone r√©sultat */
    #result.ok { color: green; margin-top: 12px; }
    #result.err { color: red; margin-top: 12px; }

    /* Colonne de droite */
    .event-details {
      display: flex;
      justify-content: center;
      gap: 16px;
    }

    .detail-box {
      flex: 1;
      background: #f0f4ff;
      padding: 16px;
      border-radius: 12px;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: 140px;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.05);
    }

    .detail-box h3 {
      margin: 8px 0 4px;
      font-size: 16px;
      color: #222;
      font-weight: 600;
    }

    .detail-box p {
      margin: 2px 0;
      font-size: 14px;
      color: #555;
    }

    .flight-number {
      text-align: center;
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
      color: #111;
    }

    /* Ic√¥nes SVG anim√©es */
    .icon {
      width: 36px;
      height: 36px;
      margin: 0 auto 6px;
      fill: url(#grad);
    }

    svg defs linearGradient {
      animation: gradientShift 5s ease infinite alternate;
    }

    @keyframes gradientShift {
      0% { stop-color: #007BFF; }
      100% { stop-color: #00C6FF; }
    }

    /* Spinner anim√© */
    .spinner {
      display:inline-block;
      width:16px;
      height:16px;
      border:2px solid #fff;
      border-top-color: transparent;
      border-radius:50%;
      animation:spin 0.8s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media(max-width:640px){
      .form-columns {
        flex-direction: column;
        gap: 16px;
      }
      .form-left::after {
        display:none;
      }
      .form-left {
        padding-right:0;
        margin-bottom:16px;
      }
      .event-details {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<div class="form-container">
  <form id="rsvp-form">
    <div class="form-columns">
      <!-- Colonne gauche -->
      <div class="form-left">
        <div class="form-group">
          <label for="prenom">Pr√©nom</label>
          <input type="text" id="prenom" name="prenom" required>
        </div>
        <div class="form-group">
          <label for="nom">Nom</label>
          <input type="text" id="nom" name="nom" required>
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
          <label for="participation">Participation</label>
          <select id="participation" name="participation" required>
            <option value="">Choisir‚Ä¶</option>
            <option value="oui">Oui</option>
            <option value="non">Non</option>
          </select>
        </div>
        <div class="form-group">
          <label for="nb_personnes">Nombre de personnes</label>
          <input type="number" id="nb_personnes" name="nb_personnes" min="1" required>
        </div>
        <button type="submit" id="submitBtn">
          <span>Envoyer</span>
        </button>
        <div id="result"></div>
      </div>

      <!-- Colonne droite -->
      <div class="form-right">
        <svg width="0" height="0">
          <defs>
            <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#007BFF">
                <animate attributeName="stop-color" values="#007BFF;#00C6FF;#007BFF" dur="5s" repeatCount="indefinite"/>
              </stop>
              <stop offset="100%" stop-color="#00C6FF">
                <animate attributeName="stop-color" values="#00C6FF;#007BFF;#00C6FF" dur="5s" repeatCount="indefinite"/>
              </stop>
            </linearGradient>
          </defs>
        </svg>

        <div class="event-details">
          <div class="detail-box">
            <!-- SVG avion d√©collage -->
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M2.5 19h19v2h-19v-2zm4.2-9.6l2.5.7 4.3-6.2 2.4.7-3.3 8.2 6.1 1.7c1.6.5 2.9 1.7 3.3 3.3l.3 1.2-19-5.2.5-1.8c.4-1.6 2.1-2.6 3.9-2.1z"/>
            </svg>
            <h3>Salle des f√™tes d‚ÄôAmanz√©</h3>
            <p>04 Avril 2026</p>
            <p>12:00</p>
          </div>
          <div class="detail-box">
            <!-- SVG avion atterrissage -->
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M2.5 19h19v2h-19v-2zm16.9-6.7l-6.5-1.9-2.9-8.4-2.4.7 1.9 8.6-4.4-1.2-.6 2.1 16.6 4.5.6-2.2c.5-1.7-.5-3.5-2.3-4.2z"/>
            </svg>
            <h3>La retraite</h3>
            <p>Arriv√©e</p>
          </div>
        </div>
        <div class="flight-number">Vol n¬∞ AF7426</div>
      </div>
    </div>
  </form>
</div>
<script>
// --- Script Google Sheets + anti-spam + confetti ---
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwQZAC1BrnLyndTvt1AlSERvATWI5hYwW4dFZAzfx2O39A8yrKWKRy06Qi5EUSrYf3R4Q/exec";
const LOCK_AFTER_SUCCESS = true;
const ANTISPAM_DELAY = 30;

const form = document.getElementById("invitationForm");
const submitBtn = document.getElementById("submitBtn");
const fields = ["prenom","nom","email","participation","nb_personnes"];
fields.forEach(id=>{
  const el=document.getElementById(id);
  const saved=localStorage.getItem(id);
  if(el && saved) el.value=saved;
  if(!el) return;
  el.addEventListener("input",e=>localStorage.setItem(id,e.target.value));
});

const result = document.createElement("p");
result.id="result";
result.style.textAlign="center";
result.style.fontWeight="600";
form.appendChild(result);

const loader = document.createElement("div");
loader.id="loader";
loader.style.display="none";
loader.style.textAlign="center";
loader.style.marginTop="8px";
loader.innerHTML='<span class="spinner"></span> Envoi‚Ä¶';
form.appendChild(loader);

function launchConfetti(count=40){
  for(let i=0;i<count;i++){
    const c=document.createElement("div");
    c.className="confetti";
    const hue=Math.floor(Math.random()*360);
    const size=6+Math.random()*10;
    const left=Math.random()*100;
    const dx=(Math.random()*200-100)+"px";
    const dur=(2+Math.random()*2).toFixed(2)+"s";
    c.style.backgroundColor=`hsl(${hue} 90% 55%)`;
    c.style.left=left+"vw";
    c.style.width=c.style.height=size+"px";
    c.style.setProperty("--dx",dx);
    c.style.animationDuration=dur;
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),parseFloat(dur)*1000);
  }
}

function showMessage(msg,cls){
  result.textContent=msg;
  result.className=cls;
}

function setLoading(loading){
  if(loading){
    loader.style.display="block";
    submitBtn.disabled=true;
    submitBtn.innerHTML=`<span>Envoi‚Ä¶</span>`;
  } else {
    loader.style.display="none";
    submitBtn.disabled=false;
    submitBtn.innerHTML=`<span>Envoyer</span>`;
  }
}

let isSubmitting=false;
let cooldownTimer=null;

form.addEventListener("submit", async e=>{
  e.preventDefault();
  if(isSubmitting) return;
  if(!form.reportValidity()) return;

  const prenom=document.getElementById("prenom").value.trim();
  const nom=document.getElementById("nom").value.trim();
  const email=document.getElementById("email").value.trim();
  const participation=document.getElementById("participation").value;
  const nb_personnes=document.getElementById("nb_personnes").value;

  isSubmitting=true; setLoading(true);
  const params=new URLSearchParams(new FormData(form));

  try{
    const res=await fetch(SHEET_URL,{method:"POST",body:params});
    const text=await res.text();

    if(res.ok){
      showMessage(`Merci ${prenom} ${nom}, votre enregistrement est confirm√© ! üéä`,"ok");
      form.reset();
      fields.forEach(id=>localStorage.removeItem(id));
      if(LOCK_AFTER_SUCCESS){
        submitBtn.disabled=true;
        submitBtn.innerHTML=`<span>‚úî Envoy√©</span>`;
        submitBtn.style.backgroundColor="#999";
        submitBtn.style.cursor="not-allowed";
      }
    } else {
      showMessage(`Erreur lors de l'envoi. ${text}`,"err");
    }

  } catch(err){
    showMessage("Erreur lors de l'envoi. V√©rifiez votre connexion.","err");
    console.error(err);
  } finally{
    isSubmitting=false; setLoading(false);
  }
});
</script>
</body>
</html>



